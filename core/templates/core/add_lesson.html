<!-- core/templates/core/add_lesson.html (–¥–æ–ø–æ–ª–Ω–µ–Ω–∏–µ –∫ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–º—É) -->
{% extends 'core/base.html' %}

{% block title %}–î–æ–±–∞–≤–∏—Ç—å —É—Ä–æ–∫{% endblock %}

{% block extra_css %}
<style>
    .html-guide {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        border-radius: 10px;
        padding: 1.5rem;
        margin-bottom: 1.5rem;
    }
    
    .html-tags-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 1rem;
        margin-top: 1rem;
    }
    
    .html-tag {
        background: rgba(255,255,255,0.1);
        padding: 0.75rem;
        border-radius: 6px;
        font-family: monospace;
        font-size: 0.9rem;
    }
    
    .html-example {
        background: white;
        color: #2d3748;
        border-radius: 6px;
        padding: 1rem;
        margin: 0.5rem 0;
        border-left: 4px solid #48bb78;
    }
    
    .video-help {
        background: #fff5f5;
        border-radius: 8px;
        padding: 1rem;
        margin: 1rem 0;
        border-left: 4px solid #f56565;
    }
</style>
{% endblock %}

{% block content %}
<div style="max-width: 800px; margin: 0 auto; padding: 2rem 1rem;">
    <div style="background: rgba(255,255,255,0.95); border-radius: 10px; padding: 2rem; box-shadow: 0 4px 6px rgba(0,0,0,0.1);">
        <!-- ... —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π –∫–æ–¥ –∑–∞–≥–æ–ª–æ–≤–∫–∞ ... -->
        
        <!-- –ì–∏–¥ –ø–æ HTML -->
        <div class="html-guide">
            <h3 style="margin-top: 0; margin-bottom: 1rem;">üé® –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ HTML-—Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—é</h3>
            <p style="opacity: 0.9; margin-bottom: 1rem;">
                –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ HTML —Ç–µ–≥–∏ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–Ω—Ç–∞. –í—Å–µ —Ç–µ–≥–∏ –ø—Ä–æ—Ö–æ–¥—è—Ç –ø—Ä–æ–≤–µ—Ä–∫—É –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏.
            </p>
            
            <div class="html-tags-grid">
                <div class="html-tag">&lt;h2&gt;–ó–∞–≥–æ–ª–æ–≤–æ–∫&lt;/h2&gt;</div>
                <div class="html-tag">&lt;p&gt;–ê–±–∑–∞—Ü&lt;/p&gt;</div>
                <div class="html-tag">&lt;ul&gt;&lt;li&gt;–°–ø–∏—Å–æ–∫&lt;/li&gt;&lt;/ul&gt;</div>
                <div class="html-tag">&lt;a href="#"&gt;–°—Å—ã–ª–∫–∞&lt;/a&gt;</div>
                <div class="html-tag">&lt;img src="url"&gt;</div>
                <div class="html-tag">&lt;strong&gt;–ñ–∏—Ä–Ω—ã–π&lt;/strong&gt;</div>
            </div>
        </div>
        
        <div class="html-example">
            <h4>üìù –ü—Ä–∏–º–µ—Ä —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–Ω—Ç–∞:</h4>
            <pre style="background: #f7fafc; padding: 1rem; border-radius: 6px; overflow-x: auto;">
&lt;h2&gt;–û—Å–Ω–æ–≤—ã –≤–æ–µ–Ω–Ω–æ–π —Å–ª—É–∂–±—ã&lt;/h2&gt;

&lt;p&gt;–í–æ–µ–Ω–Ω–∞—è —Å–ª—É–∂–±–∞ - —ç—Ç–æ &lt;strong&gt;–æ—Å–æ–±—ã–π –≤–∏–¥ –≥–æ—Å—É–¥–∞—Ä—Å—Ç–≤–µ–Ω–Ω–æ–π —Å–ª—É–∂–±—ã&lt;/strong&gt;.&lt;/p&gt;

&lt;h3&gt;–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ —Å–ª—É–∂–±—ã:&lt;/h3&gt;
&lt;ul&gt;
  &lt;li&gt;–§–∏–∑–∏—á–µ—Å–∫–æ–µ —Ä–∞–∑–≤–∏—Ç–∏–µ&lt;/li&gt;
  &lt;li&gt;–î–∏—Å—Ü–∏–ø–ª–∏–Ω–∞&lt;/li&gt;
  &lt;li&gt;–ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–µ –Ω–∞–≤—ã–∫–∏&lt;/li&gt;
&lt;/ul&gt;

&lt;h3&gt;–ü–æ–ª–µ–∑–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã:&lt;/h3&gt;
&lt;p&gt;–ü–æ–¥—Ä–æ–±–Ω–µ–µ –Ω–∞ &lt;a href="https://mil.ru"&gt;–æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–æ–º —Å–∞–π—Ç–µ&lt;/a&gt;.&lt;/p&gt;

&lt;img src="/media/military_image.jpg" alt="–í–æ–µ–Ω–Ω–∞—è –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞"&gt;</pre>
        </div>
        
        <!-- –ü–æ–º–æ—â—å –ø–æ –≤–∏–¥–µ–æ -->
        <div class="video-help">
            <h4 style="color: #c53030; margin-top: 0;">üé• –ö–∞–∫ –¥–æ–±–∞–≤–∏—Ç—å –≤–∏–¥–µ–æ?</h4>
            <p style="color: #742a2a;">–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã:</p>
            <ul style="color: #742a2a; padding-left: 1.5rem;">
                <li><strong>YouTube:</strong> https://www.youtube.com/watch?v=ID_–≤–∏–¥–µ–æ</li>
                <li><strong>Rutube:</strong> https://rutube.ru/video/ID_–≤–∏–¥–µ–æ/</li>
            </ul>
            <p style="color: #742a2a; font-size: 0.9rem; margin-top: 0.5rem;">
                –í–∏–¥–µ–æ –±—É–¥–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤—Å—Ç—Ä–æ–µ–Ω–æ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É —É—Ä–æ–∫–∞.
            </p>
        </div>
        
        <!-- –°—É—â–µ—Å—Ç–≤—É—é—â–∞—è —Ñ–æ—Ä–º–∞ -->
        <form method="post">
            {% csrf_token %}
            
            <!-- ... —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –ø–æ–ª—è —Ñ–æ—Ä–º—ã ... -->
            
            <!-- –ü–æ–ª–µ –∫–æ–Ω—Ç–µ–Ω—Ç–∞ —Å –ø–æ–¥—Å–∫–∞–∑–∫–æ–π -->
            <div style="margin-bottom: 1.5rem;">
                <label for="id_content" style="display: block; color: #2d3748; margin-bottom: 0.5rem; font-weight: 500; font-size: 1.1rem;">
                    {{ form.content.label }}
                    <span style="color: #e53e3e;">*</span>
                </label>
                {{ form.content }}
                {% if form.content.errors %}
                    <div style="color: #e53e3e; font-size: 0.875rem; margin-top: 0.25rem;">
                        {% for error in form.content.errors %}
                            <p style="margin: 0.25rem 0;">{{ error }}</p>
                        {% endfor %}
                    </div>
                {% endif %}
                <div style="color: #718096; font-size: 0.875rem; margin-top: 0.25rem;">
                    {{ form.content.help_text }}
                </div>
            </div>
            
            <!-- ... –æ—Å—Ç–∞–ª—å–Ω—ã–µ –ø–æ–ª—è —Ñ–æ—Ä–º—ã ... -->
        </form>
    </div>
</div>

<script>
    document.addEventListener('DOMContentLoaded', function() {
        const contentTextarea = document.getElementById('id_content');
        const videoUrlInput = document.getElementById('id_video_url');
        
        // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ç–∏–ø–∞ –≤–∏–¥–µ–æ
        if (videoUrlInput) {
            videoUrlInput.addEventListener('input', function() {
                const url = this.value;
                const preview = document.getElementById('video-preview');
                
                if (!preview) {
                    const previewDiv = document.createElement('div');
                    previewDiv.id = 'video-preview';
                    previewDiv.style.marginTop = '0.5rem';
                    this.parentNode.appendChild(previewDiv);
                }
                
                if (url.includes('youtube.com') || url.includes('youtu.be')) {
                    preview.innerHTML = '<span style="color: #48bb78;">‚úì YouTube –≤–∏–¥–µ–æ –±—É–¥–µ—Ç –≤—Å—Ç—Ä–æ–µ–Ω–æ</span>';
                } else if (url.includes('rutube.ru')) {
                    preview.innerHTML = '<span style="color: #48bb78;">‚úì Rutube –≤–∏–¥–µ–æ –±—É–¥–µ—Ç –≤—Å—Ç—Ä–æ–µ–Ω–æ</span>';
                } else if (url) {
                    preview.innerHTML = '<span style="color: #e53e3e;">‚ö† –°—Å—ã–ª–∫–∞ –Ω–µ —Ä–∞—Å–ø–æ–∑–Ω–∞–Ω–∞. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ YouTube –∏–ª–∏ Rutube</span>';
                } else {
                    preview.innerHTML = '';
                }
            });
        }
        
        // –ë—ã—Å—Ç—Ä–∞—è –≤—Å—Ç–∞–≤–∫–∞ HTML —Ç–µ–≥–æ–≤
        const quickTags = document.querySelectorAll('.quick-tag');
        quickTags.forEach(tag => {
            tag.addEventListener('click', function() {
                const tagName = this.dataset.tag;
                const cursorPos = contentTextarea.selectionStart;
                const textBefore = contentTextarea.value.substring(0, cursorPos);
                const textAfter = contentTextarea.value.substring(cursorPos);
                
                let insertText = '';
                switch(tagName) {
                    case 'h2':
                        insertText = '\n<h2></h2>\n';
                        break;
                    case 'p':
                        insertText = '\n<p></p>\n';
                        break;
                    case 'ul':
                        insertText = '\n<ul>\n  <li></li>\n</ul>\n';
                        break;
                    case 'img':
                        insertText = '\n<img src="" alt="">\n';
                        break;
                    case 'a':
                        insertText = '<a href=""></a>';
                        break;
                }
                
                contentTextarea.value = textBefore + insertText + textAfter;
                contentTextarea.focus();
            });
        });
    });
</script>
{% endblock %}